<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Experiencia Interactiva</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            overflow: hidden; /* Evita el scroll */
            cursor: pointer;
            touch-action: none; /* Deshabilita gestos del navegador en móviles */
        }
        /* Contenedor principal que ocupa toda la pantalla */
        #experience-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            background-color: #000;
            overflow: hidden;
        }

        /* Contenedor para todas las escenas */
        #scene-container {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            opacity: 1;
            transition: opacity 0.5s ease-in-out, filter 0.5s ease-in-out; /* Transición para el desvanecimiento y el blur */
        }
        
        /* Clase para el efecto blur */
        #scene-container.blurred {
            filter: blur(4px);
        }

        .scene {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            opacity: 0;
            transition: opacity 1s ease-in-out;
        }
        .scene.active {
            opacity: 1;
        }

        /* Párpados con borde difuminado */
        .eyelid {
            position: absolute;
            left: -25vw; /* Centrar el párpado más ancho */
            width: 150vw; /* Hacerlo más ancho que la pantalla para que la curva cubra las esquinas */
            height: 50%;
            background-color: #200505; /* Negro rojizo */
            z-index: 10;
            transition: transform 0.7s cubic-bezier(0.77, 0, 0.175, 1);
        }
        #top-eyelid {
            top: 0;
            transform-origin: top;
            border-bottom-left-radius: 100%;
            border-bottom-right-radius: 100%;
            box-shadow: 0px 4px 8px 2px #200505;
        }
        #bottom-eyelid {
            bottom: 0;
            transform-origin: bottom;
            border-top-left-radius: 100%;
            border-top-right-radius: 100%;
            box-shadow: 0px -4px 8px 2px #200505;
        }

        /* Estados de los párpados */
        .eyes-closed #top-eyelid { transform: scaleY(1); }
        .eyes-closed #bottom-eyelid { transform: scaleY(1); }
        .eyes-open #top-eyelid { transform: scaleY(0); }
        .eyes-open #bottom-eyelid { transform: scaleY(0); }

        /* Menú Radial */
        #radial-menu {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 500px;
            height: 500px;
            z-index: 20;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s ease-in-out;
        }
        #radial-menu.visible {
            opacity: 1;
            pointer-events: auto;
        }
        .menu-item {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            padding: 10px 15px;
            white-space: nowrap;
            font-size: 1.25rem; /* Letras más grandes */
            font-weight: 500;
            filter: blur(1.5px); /* Pequeño blur por defecto */
            transition: filter 0.3s, transform 0.3s;
        }
        /* Estilo para la opción central */
        .menu-item-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: rgba(255, 255, 255, 0.7);
            font-size: 1.25rem;
            font-weight: 500;
        }

        /* Texto de la pregunta */
        #question-display {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 90%;
            transform: translate(-50%, -50%);
            z-index: 5;
            color: white;
            font-size: clamp(1.5rem, 5vw, 3rem);
            font-weight: bold;
            text-align: center;
            text-shadow: 2px 2px 8px rgba(0,0,0,0.8);
            opacity: 0;
            transition: opacity 1s ease-in-out, filter 0.5s ease-in-out; /* Añadida transición para el blur */
            pointer-events: none;
        }
        #question-display.visible {
            opacity: 1;
        }
        #question-display.blurred {
            filter: blur(4px);
        }

        /* Advertencia de orientación */
        #orientation-warning {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-color: #000;
            color: white;
            display: none; /* Oculto por defecto */
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            text-align: center;
            padding: 20px;
        }
        .rotate-icon {
            width: 50px;
            height: 80px;
            border: 4px solid white;
            border-radius: 10px;
            margin-bottom: 20px;
            animation: rotate-animation 1.5s ease-in-out infinite;
        }
        @keyframes rotate-animation {
            0% { transform: rotate(0deg); }
            50% { transform: rotate(90deg); }
            100% { transform: rotate(90deg); }
        }
        .hidden {
            display: none !important;
        }
    </style>
</head>
<body class="bg-black">

    <div id="experience-container">
        <!-- Contenedor de escenas para controlar el fade-out global -->
        <div id="scene-container">
            <!-- Escena 0: Inicial / Central -->
            <div id="scene-0" class="scene" style="background-image: url('https://www.shutterstock.com/image-photo/firstperson-view-man-sitting-on-260nw-640592416.jpg');"></div>
            <!-- Escenas del Menú Radial -->
            <div id="scene-1" class="scene" style="background-image: url('https://media.istockphoto.com/id/477603280/photo/pov-image-of-woman-in-pose-of-lotus.jpg?s=612x612&w=0&k=20&c=GNBR0B0xZw12b3P1E_Ms4c29Vs4FdihDuH6pNppRUr0=');"></div> <!-- EspiritualMente -->
            <div id="scene-2" class="scene" style="background-image: url('https://www.shutterstock.com/shutterstock/videos/3500096663/thumb/1.jpg?ip=x480');"></div> <!-- FísicaMente -->
            <div id="scene-3" class="scene" style="background-image: url('https://as2.ftcdn.net/jpg/04/80/85/87/1000_F_480858770_rCyhkUjYn7jHTvhFDQfHvQ9tADq1zoAS.jpg');"></div> <!-- IntelectualMente -->
            <div id="scene-4" class="scene" style="background-image: url('https://media.istockphoto.com/id/518701333/photo/friends-socialising.jpg?s=612x612&w=0&k=20&c=xnDbkFKEkVw81fRn_HJuTPRpjD3A4VfHCXej4Twg0kU=');"></div> <!-- RelacionalMente -->
            <div id="scene-5" class="scene" style="background-image: url('https://media.istockphoto.com/id/1358520260/photo/pov-of-young-woman-relaxing-at-home-with-cup-of-coffee-lying-on-couch.jpg?s=612x612&w=0&k=20&c=fwgy8sHJQz9RRXiZTpcC2ynrgZJD1mwXNvww3r2AKvg=');"></div> <!-- EmocionalMente -->
        </div>

        <!-- Display de la pregunta -->
        <div id="question-display"></div>

        <!-- Párpados -->
        <div id="eyelids-container" class="eyes-closed">
            <div id="top-eyelid" class="eyelid"></div>
            <div id="bottom-eyelid" class="eyelid"></div>
        </div>

        <!-- Menú Radial -->
        <div id="radial-menu"></div>
    </div>

    <!-- Advertencia de Orientación -->
    <div id="orientation-warning">
        <div class="rotate-icon"></div>
        <p class="text-lg">Por favor, gira tu dispositivo a modo horizontal para continuar.</p>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const container = document.getElementById('experience-container');
            const eyelids = document.getElementById('eyelids-container');
            const radialMenu = document.getElementById('radial-menu');
            const questionDisplay = document.getElementById('question-display');
            const sceneContainer = document.getElementById('scene-container');
            const orientationWarning = document.getElementById('orientation-warning');

            const menuItems = [
                "EspiritualMente", "FísicaMente", "IntelectualMente",
                "RelacionalMente", "EmocionalMente"
            ];
            
            let isMouseDown = false;
            let menuBecameVisible = false;
            let selectedMenuIndex = -1;
            let currentSceneNumber = 0;
            let questionTimeout;
            let menuTimeout;
            let blurTimeout;

            // --- Funciones de la animación ---

            const openEyes = (optionText = null) => {
                sceneContainer.style.opacity = '1';
                sceneContainer.classList.remove('blurred');
                questionDisplay.classList.remove('blurred');
                if (blurTimeout) clearTimeout(blurTimeout);

                questionDisplay.classList.remove('visible');

                eyelids.classList.remove('eyes-closed');
                eyelids.classList.add('eyes-open');
                hideMenu();
                if (optionText) {
                    showQuestion(optionText);
                }
            };

            const closeEyes = () => {
                sceneContainer.style.opacity = '0';
                questionDisplay.classList.remove('visible');
                
                eyelids.classList.remove('eyes-open');
                eyelids.classList.add('eyes-closed');
            };

            const showMenu = () => {
                radialMenu.classList.add('visible');
                menuBecameVisible = true;
            };
            
            const hideMenu = () => {
                radialMenu.classList.remove('visible');
                menuBecameVisible = false;
            };

            const showQuestion = (optionText) => {
                if (questionTimeout) clearTimeout(questionTimeout);
                if (blurTimeout) clearTimeout(blurTimeout);
                
                sceneContainer.classList.add('blurred');
                questionDisplay.classList.add('blurred');
                
                questionDisplay.textContent = `¿CÓMO ESTÁS: ${optionText}?`;
                questionDisplay.classList.add('visible');

                blurTimeout = setTimeout(() => {
                    sceneContainer.classList.remove('blurred');
                    questionDisplay.classList.remove('blurred');
                }, 2000);

                questionTimeout = setTimeout(() => {
                    questionDisplay.classList.remove('visible');
                }, 4000);
            };

            const changeScene = (newSceneNumber) => {
                if (newSceneNumber === currentSceneNumber) return;
                
                const currentSceneEl = document.getElementById(`scene-${currentSceneNumber}`);
                const newSceneEl = document.getElementById(`scene-${newSceneNumber}`);

                if(currentSceneEl) currentSceneEl.classList.remove('active');
                if(newSceneEl) newSceneEl.classList.add('active');
                
                currentSceneNumber = newSceneNumber;
            };

            // --- Creación del Menú Radial ---
            const createRadialMenu = () => {
                const centerItem = document.createElement('div');
                centerItem.className = 'menu-item-center';
                centerItem.textContent = '¿Cómo estás?';
                radialMenu.appendChild(centerItem);

                const radius = 180;
                const angleStep = (2 * Math.PI) / menuItems.length;

                menuItems.forEach((itemText, index) => {
                    const angle = index * angleStep - (Math.PI / 2);
                    const x = radius * Math.cos(angle);
                    const y = radius * Math.sin(angle);

                    const menuItem = document.createElement('div');
                    menuItem.className = 'menu-item';
                    menuItem.textContent = itemText;
                    const transformValue = `translate(-50%, -50%) translate(${x}px, ${y}px)`;
                    menuItem.style.transform = transformValue;
                    menuItem.dataset.originalTransform = transformValue; // Guardar transform original
                    menuItem.dataset.menuIndex = index;

                    radialMenu.appendChild(menuItem);
                });
            };

            // --- Lógica de Eventos Unificada ---

            const handleInteractionStart = (e) => {
                e.preventDefault();
                isMouseDown = true;
                if (menuTimeout) clearTimeout(menuTimeout);
                closeEyes();

                menuTimeout = setTimeout(() => {
                    if (isMouseDown) {
                        showMenu();
                    }
                }, 800);
            };

            const handleInteractionEnd = (e) => {
                e.preventDefault();
                if (!isMouseDown) return;
                isMouseDown = false;
                if (menuTimeout) clearTimeout(menuTimeout);

                let selectedText = null;
                if (menuBecameVisible && selectedMenuIndex !== -1) {
                    const newSceneNumber = selectedMenuIndex + 1;
                    changeScene(newSceneNumber);
                    selectedText = menuItems[selectedMenuIndex];
                } else if (menuBecameVisible) {
                    changeScene(0);
                }
                
                openEyes(selectedText);
                selectedMenuIndex = -1;
            };
            
            const handleInteractionMove = (e) => {
                if (!isMouseDown || !menuBecameVisible) return;
                e.preventDefault();

                const x = e.touches ? e.touches[0].clientX : e.clientX;
                const y = e.touches ? e.touches[0].clientY : e.clientY;

                const elementUnderPoint = document.elementFromPoint(x, y);
                let newlySelectedItem = null;

                if (elementUnderPoint && elementUnderPoint.classList.contains('menu-item')) {
                    newlySelectedItem = elementUnderPoint;
                }

                document.querySelectorAll('.menu-item').forEach(item => {
                    if (item === newlySelectedItem) {
                        item.style.filter = 'blur(0)';
                        item.style.transform = `${item.dataset.originalTransform} scale(1.1)`;
                        selectedMenuIndex = parseInt(item.dataset.menuIndex, 10);
                    } else {
                        item.style.filter = 'blur(1.5px)';
                        item.style.transform = item.dataset.originalTransform;
                    }
                });

                if (!newlySelectedItem) {
                    selectedMenuIndex = -1;
                }
            };

            // --- Detección de Orientación ---
            const checkOrientation = () => {
                if (window.matchMedia("(orientation: portrait)").matches) {
                    orientationWarning.style.display = 'flex';
                    container.classList.add('hidden');
                } else {
                    orientationWarning.style.display = 'none';
                    container.classList.remove('hidden');
                }
            };

            // --- Inicialización ---
            const initializeExperience = () => {
                createRadialMenu();
                document.getElementById('scene-0').classList.add('active');

                // Listeners para Mouse
                container.addEventListener('mousedown', handleInteractionStart);
                container.addEventListener('mouseup', handleInteractionEnd);
                container.addEventListener('mousemove', handleInteractionMove);
                // Listeners para Touch
                container.addEventListener('touchstart', handleInteractionStart);
                container.addEventListener('touchend', handleInteractionEnd);
                container.addEventListener('touchmove', handleInteractionMove);

                // Listeners para Orientación
                window.addEventListener('resize', checkOrientation);
                window.addEventListener('orientationchange', checkOrientation);
                
                // Comprobación inicial
                checkOrientation();

                setTimeout(() => {
                    openEyes();
                }, 2000);
            };

            initializeExperience();
        });
    </script>

</body>
</html>
